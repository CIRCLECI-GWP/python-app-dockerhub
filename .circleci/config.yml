version: 2.1
orbs:
  python: circleci/python@2.1.1
jobs:
  build-and-test:
    executor: python/default
    steps:
      - checkout
      - python/install-packages:
          pkg-manager: pip
      - run:
          name: Install dependencies
          command: |
            python3 -m venv venv
            . venv/bin/activate
            pip install -r requirements.txt

      - run:
          name: Test with pytest
          command: pytest

workflows:
  build-master:
    jobs:
      - build-and-test
# version: '2.1'
# orbs:
#   python: circleci/python@1.1.0
# jobs:
#   build:
#     executor: python/default
#     steps:
#       - checkout
#       - python/install-packages:
#           pkg-manager: pip
#       - python/install-packages:
#           pip-dependency-file: dev-requirements.txt
#           pkg-manager: pip
#       - python/install-packages:
#           args: pytest
#           pkg-manager: pip
#           pypi-cache: false
#       - run:
#           command: |
#             pytest --version
#           name: Test
# workflows:
#   main:
#     jobs:
# - build
